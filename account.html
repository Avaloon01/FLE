<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mon compte — FLE</title>
  <link rel="stylesheet" href="assets/css/styles.css">
  <script defer src="assets/js/app.js"></script>
</head>
<body>
  <header>
    <div class="nav">
      <strong>FLE Vocabulaire</strong>
      <a href="index.html">Thématiques</a>
      <a href="vocab.html">Vocabulaire</a>
      <a href="game.html">Jeu</a>
      <a href="account.html">Mon compte</a>
    </div>
  </header>
  <main class="container">
    <h1>Mon compte</h1>
    <div class="grid">
      <div class="card">
        <h3>Se connecter</h3>
        <label>Prénom ou pseudo</label>
        <input id="name" placeholder="Eliott">
        <div class="options">
          <button class="btn" id="login">Connexion</button>
          <button class="btn btn-ghost" id="logout">Déconnexion</button>
        </div>
        <p class="small">Les progrès sont enregistrés dans ce navigateur (localStorage).</p>
      </div>
      <div class="card">
        <h3>Mes progrès</h3>
        <div id="progress">Aucun utilisateur connecté.</div>
      </div>
    </div>
  </main>
  <footer>FLE — Données stockées localement (pas de serveur).</footer>
  <script>
    const { Store, loadVocab } = FLEVocab;
    const nameInput = document.getElementById('name');
    document.getElementById('login').onclick = () => {
      const n = (nameInput.value || '').trim();
      if(!n) return alert('Entre un nom.');
      Store.setCurrentUser(n);
      render();
    };
    document.getElementById('logout').onclick = () => {
      localStorage.removeItem('flevocab.currentUser'); render();
    };
    function renderProgress(allThemes, user){
      const p = user.data.progress || {};
      let html = '';
      for(const theme of Object.keys(allThemes)){
        const rec = p[theme] || {attempts:0, correct:0};
        const ratio = rec.attempts ? Math.round(100*rec.correct/rec.attempts) : 0;
        html += `<div class="card"><strong>${theme}</strong>
        <div class="small">${rec.correct}/${rec.attempts} corrects</div>
        <div class="progress"><span style="width:${ratio}%;"></span></div>
        </div>`;
      }
      return html || '<p class="small">Aucune donnée.</p>';
    }
    async function render(){
      const user = Store.getCurrentUser();
      const vocab = await loadVocab();
      const box = document.getElementById('progress');
      if(!user){ box.innerHTML = 'Aucun utilisateur connecté.'; return; }
      box.innerHTML = renderProgress(vocab, user);
    }
    render();
  </script>
</body>
</html>
